(this["webpackJsonpbook-store"]=this["webpackJsonpbook-store"]||[]).push([[0],{50:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(17),a=n.n(c),s=n(4),o=n(13),i=n(37),u=n(38),l=n(10),j="LOGIN",b="API_ERROR",d="LOGIN_FROM_LOCAL_STORAGE",O="LOAD_ALL_BOOKS",h="LOG_OUT",p={user:{},username:null,loading:!0,error:null,books:[],isAuthenticated:!1};var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(l.a)(Object(l.a)({},e),{},{loading:!1,user:t.userInfo,isAuthenticated:!0});case b:return Object(l.a)(Object(l.a)({},e),{},{loading:!1,error:t.err});case d:return Object(l.a)(Object(l.a)({},e),{},{user:t.userInfo});case O:return Object(l.a)(Object(l.a)({},e),{},{loading:!1,books:t.books});case h:return Object(l.a)(Object(l.a)({},e),{},{user:{}});default:return e}},x=Object(o.createStore)(f,Object(i.composeWithDevTools)(Object(o.applyMiddleware)(u.a))),v=n(20),m=(n(50),n(11)),g=n.n(m),k=n(14),N=n(19),y=n(24),w=n.n(y),S=new function e(){var t=this;Object(N.a)(this,e),this._apiBase="https://js-band-store-api.glitch.me",this.login=function(){var e=Object(k.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.a.post("".concat(t._apiBase,"/signin"),{username:n});case 3:if(200===(r=e.sent).status){e.next=6;break}throw new Error("Unable to login. Status code ".concat(r.status));case 6:return e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to login. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.getAllBooks=function(){var e=Object(k.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.a.get("".concat(t._apiBase,"/books"),{headers:{Authorization:"Bearer ".concat(n)}});case 3:if(200===(r=e.sent).status){e.next=6;break}throw new Error("Unable to load all books. Status code ".concat(r.status));case 6:return e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to load all book. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},I=n(3),E=n(1),A=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.error})),n=Object(s.c)((function(e){return e.user})),c=Object(r.useState)(""),a=Object(v.a)(c,2),o=a[0],i=a[1],u=Object(r.useState)(!1),l=Object(v.a)(u,2),O=l[0],h=l[1],p=Object(r.useState)("username-input"),f=Object(v.a)(p,2),x=f[0],m=f[1],N=localStorage.getItem("userInfo");Object(r.useEffect)((function(){var t;null!==N&&e((t=JSON.parse(N),{type:d,userInfo:t}))}),[e,N]);return n.token?Object(E.jsx)(I.a,{to:"/catalog"}):Object(E.jsxs)("div",{className:"login-container",children:[Object(E.jsx)("p",{className:"login-title",align:"center",children:"JS Band Store"}),Object(E.jsx)("div",{children:Object(E.jsx)("img",{className:"login-image",src:"/public/assets/login2.png",alt:"login"})}),t?Object(E.jsx)(C,{}):Object(E.jsx)(L,{inputClasses:x,usernameValue:o,handleChangeUsername:function(e){var t=e.target.value;i(t.trim()),3<t.length&&t.length<17?h(!1):h(!0)},handleLogin:function(t){var n;t.preventDefault(),O||!o?m("username-input incorrect-username"):(m("username-input"),console.log("login"),e((n=o,function(){var e=Object(k.a)(g.a.mark((function e(t){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.login(n);case 3:r=e.sent,localStorage.setItem("userInfo",JSON.stringify(r)),t({type:j,userInfo:r}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0.message),t({type:b,err:e.t0});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())))}})]})},L=function(e){var t=e.inputClasses,n=e.usernameValue,r=e.handleChangeUsername,c=e.handleLogin;return Object(E.jsxs)("form",{className:"login-form",children:[Object(E.jsx)("input",{className:t,type:"text",align:"center",placeholder:"Username",value:n,onChange:r}),Object(E.jsx)("p",{className:"help-text",children:"\u26a1 Your username must be 4-16 characters long."}),Object(E.jsx)("a",{className:"submit",align:"center",href:"/",onClick:c,children:"Log in"})]})},B=(n(72),function(){return Object(E.jsx)("div",{className:"loadingio-spinner-spinner-x0uuoqp72gm",children:Object(E.jsxs)("div",{className:"ldio-yz9ydzph78",children:[Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{}),Object(E.jsx)("div",{})]})})}),C=(n(73),function(){return Object(E.jsx)("div",{className:"error-indicator",children:"An error has occurred. Try reloading the page."})}),_=n(39),U=n(41),J=n(40),R=function(e){Object(U.a)(n,e);var t=Object(J.a)(n);function n(){var e;Object(N.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(_.a)(n,[{key:"render",value:function(){return this.state.hasError?Object(E.jsx)(C,{}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),n}(r.Component),D=(n(74),function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user}));return t.token?Object(E.jsxs)("header",{children:[Object(E.jsxs)("div",{className:"sign-out",children:[t.username,Object(E.jsx)("i",{className:"fas fa-sign-out-alt",onClick:function(){return e((localStorage.removeItem("userInfo"),{type:h}))}})]}),Object(E.jsxs)("div",{className:"header d-flex justify-content-between",children:[Object(E.jsx)("h1",{className:"header-title",children:"JS Band Store"}),Object(E.jsxs)("div",{className:"shopping-cart",children:[Object(E.jsx)("i",{className:"fas fa-shopping-cart"}),"Cart (3)"]})]})]}):null}),G=(n(75),function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.books})),n=Object(s.c)((function(e){return e.user})),c=Object(s.c)((function(e){return e.error})),a=Object(s.c)((function(e){return e.loading}));Object(r.useEffect)((function(){var t;n.token&&e((t=n.token,function(){var e=Object(k.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.getAllBooks(t);case 3:r=e.sent,n({type:O,books:r}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message),n({type:b,err:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}),[e,n.token]);var o=t.map((function(e){return Object(E.jsx)(T,{book:e},e.id)}));if(!n.token)return Object(E.jsx)(I.a,{to:"/login"});var i=!(a||c)?o:null;return Object(E.jsxs)("div",{className:"book-list",children:[c&&Object(E.jsx)(C,{}),a&&Object(E.jsx)(B,{}),i]})}),T=(n(76),function(e){var t=e.book,n=t.title,r=t.author,c=t.price,a=t.cover;return Object(E.jsxs)("div",{className:"card",children:[Object(E.jsx)("img",{src:a,className:"card-text card-img",alt:n}),Object(E.jsxs)("div",{className:"card-body",children:[Object(E.jsx)("h5",{className:"card-title",children:n}),Object(E.jsx)("p",{className:"card-text",children:r}),Object(E.jsxs)("div",{className:"d-flex footer-card-section",children:[Object(E.jsxs)("p",{className:"card-text",children:[c," $"]}),Object(E.jsx)("a",{href:"/#",className:"btn btn-primary",children:"View"})]})]})]})}),z=n(15),V=(n(77),function(){var e=Object(s.c)((function(e){return e.user}));return Object(E.jsxs)("div",{className:"container",children:[e.token&&Object(E.jsx)(D,{}),Object(E.jsxs)(I.d,{children:[Object(E.jsx)(I.b,{path:"/",render:function(){return!e.token&&Object(E.jsx)(I.a,{to:"/login"})},exact:!0}),Object(E.jsx)(I.b,{path:"/login",component:A}),Object(E.jsx)(I.b,{path:"/catalog",component:G}),Object(E.jsx)(I.a,{to:"/"})]})]})});a.a.render(Object(E.jsx)(s.a,{store:x,children:Object(E.jsx)(R,{children:Object(E.jsx)(z.a,{basename:"./#/",children:Object(E.jsx)(V,{})})})}),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.db6a4644.chunk.js.map