(this["webpackJsonpbook-store"]=this["webpackJsonpbook-store"]||[]).push([[0],{53:function(e,t,c){},75:function(e,t,c){},76:function(e,t,c){},77:function(e,t,c){},78:function(e,t,c){},79:function(e,t,c){},80:function(e,t,c){},81:function(e,t,c){},82:function(e,t,c){},83:function(e,t,c){},84:function(e,t,c){},85:function(e,t,c){},86:function(e,t,c){"use strict";c.r(t);var a=c(1),r=c(20),n=c.n(r),s=c(2),o=c(16),i=c(39),l=c(40),u=c(4),j=c(43),b="LOGIN",d="API_ERROR",O="LOGIN_FROM_LOCAL_STORAGE",h="LOAD_ALL_BOOKS",p="LOG_OUT",f="LOAD_BOOK_BY_ID",x="CLEAR_SELECTED_BOOK",m="ADD_BOOK_TO_CART",v="GET_FILTER_PRICE_VALUE",g="GET_FILTER_TITLE_VALUE",k="PLACE_ORDER",N="CLEAR_CART",y={user:JSON.parse(localStorage.getItem("userInfo"))||{},username:null,loading:!0,error:null,books:[],bookDetails:{},booksInTheCart:JSON.parse(localStorage.getItem("cart"))||[],filterPriceValue:"Price",filterTitleValue:""},w=function(e,t){var c=[].concat(Object(j.a)(e.booksInTheCart),[t]);return localStorage.setItem("cart",JSON.stringify(c)),Object(u.a)(Object(u.a)({},e),{},{booksInTheCart:c})};var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,user:t.userInfo});case d:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,error:t.err});case O:return Object(u.a)(Object(u.a)({},e),{},{user:t.userInfo});case h:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,books:t.books});case p:return Object(u.a)(Object(u.a)({},e),{},{user:{}});case f:return Object(u.a)(Object(u.a)({},e),{},{bookDetails:t.bookDetails,loading:!1});case x:return Object(u.a)(Object(u.a)({},e),{},{bookDetails:{},loading:!0});case m:return w(e,t.addedBook);case v:return Object(u.a)(Object(u.a)({},e),{},{filterPriceValue:t.priceFilterValue});case g:return Object(u.a)(Object(u.a)({},e),{},{filterTitleValue:t.titleFilterValue});case k:return Object(u.a)({},e);case N:return localStorage.removeItem("cart"),Object(u.a)(Object(u.a)({},e),{},{booksInTheCart:[]});default:return e}},T=Object(o.createStore)(C,Object(i.composeWithDevTools)(Object(o.applyMiddleware)(l.a))),I=c(14),S=(c(53),c.p+"static/media/login.4c1cc414.png"),E=c(6),_=c.n(E),B=c(13),L=c(23),A=c(19),D=c.n(A),P=new function e(){var t=this;Object(L.a)(this,e),this._apiBase="https://js-band-store-api.glitch.me",this.login=function(){var e=Object(B.a)(_.a.mark((function e(c){var a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.post("".concat(t._apiBase,"/signin"),{username:c});case 3:if(200===(a=e.sent).status){e.next=6;break}throw new Error("Unable to login. Status code ".concat(a.status));case 6:return e.abrupt("return",a.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to login. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.getAllBooks=function(){var e=Object(B.a)(_.a.mark((function e(c){var a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.get("".concat(t._apiBase,"/books"),{headers:{Authorization:"Bearer ".concat(c)}});case 3:if(200===(a=e.sent).status){e.next=6;break}throw new Error("Unable to load all books. Status code ".concat(a.status));case 6:return e.abrupt("return",a.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to load all book. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadBook=function(){var e=Object(B.a)(_.a.mark((function e(c,a){var r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.get("".concat(t._apiBase,"/books/").concat(a),{headers:{Authorization:"Bearer ".concat(c)}});case 3:if(200===(r=e.sent).status){e.next=6;break}throw new Error("Unable to load book details. Status code ".concat(r.status));case 6:return e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to load book details. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,c){return e.apply(this,arguments)}}(),this.postPurchase=function(){var e=Object(B.a)(_.a.mark((function e(c,a){var r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.post("".concat(t._apiBase,"/purchase"),{books:a},{headers:{Authorization:"Bearer ".concat(c)}});case 3:if(200===(r=e.sent).status){e.next=6;break}throw new Error("Unable to place an order. Status code ".concat(r.status));case 6:return e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Unable to place an order. Status code ".concat(e.t0.response.status));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,c){return e.apply(this,arguments)}}()},V=c(5),R=c(0),U=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.error})),c=Object(s.c)((function(e){return e.user})),r=Object(a.useState)(""),n=Object(I.a)(r,2),o=n[0],i=n[1],l=Object(a.useState)(!1),u=Object(I.a)(l,2),j=u[0],O=u[1],h=Object(a.useState)("username-input"),p=Object(I.a)(h,2),f=p[0],x=p[1];return c.token?Object(R.jsx)(V.a,{to:"/catalog"}):Object(R.jsxs)("div",{className:"login-container",children:[Object(R.jsx)("p",{className:"login-title",align:"center",children:"JS Band Store"}),Object(R.jsx)("div",{children:Object(R.jsx)("img",{className:"login-image",src:S,alt:"login"})}),t?Object(R.jsx)(G,{}):Object(R.jsx)(F,{inputClasses:f,usernameValue:o,handleChangeUsername:function(e){var t=e.target.value;i(t.trim()),3<t.length&&t.length<17?O(!1):O(!0)},handleLogin:function(t){var c;t.preventDefault(),j||!o?x("username-input incorrect-username"):(x("username-input"),e((c=o,function(){var e=Object(B.a)(_.a.mark((function e(t){var a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.login(c);case 3:a=e.sent,localStorage.setItem("userInfo",JSON.stringify(a)),t({type:b,userInfo:a}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0.message),t({type:d,err:e.t0});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())))}})]})},F=function(e){var t=e.inputClasses,c=e.usernameValue,a=e.handleChangeUsername,r=e.handleLogin;return Object(R.jsxs)("form",{className:"login-form",children:[Object(R.jsx)("input",{className:t,type:"text",align:"center",placeholder:"Username",value:c,onChange:a}),Object(R.jsx)("p",{className:"help-text",children:"\u26a1 Your username must be 4-16 characters long."}),Object(R.jsx)("a",{className:"submit",align:"center",href:"/",onClick:r,children:"Log in"})]})},J=(c(75),function(){return Object(R.jsx)("div",{className:"loadingio-spinner-spinner-x0uuoqp72gm",children:Object(R.jsxs)("div",{className:"ldio-yz9ydzph78",children:[Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{}),Object(R.jsx)("div",{})]})})}),G=(c(76),function(){return Object(R.jsx)("div",{className:"error-indicator",children:"An error has occurred. Try reloading the page."})}),z=c(41),K=c(44),$=c(42),Y=function(e){Object(K.a)(c,e);var t=Object($.a)(c);function c(){var e;Object(L.a)(this,c);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1},e}return Object(z.a)(c,[{key:"render",value:function(){return this.state.hasError?Object(R.jsx)(G,{}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),c}(a.Component),M=(c(77),c(12)),q=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.user})),c=Object(s.c)((function(e){return e.booksInTheCart}));return t.token?Object(R.jsxs)("header",{children:[Object(R.jsxs)("div",{className:"sign-out",children:[t.username,Object(R.jsx)("i",{className:"fas fa-sign-out-alt",onClick:function(){return e((localStorage.removeItem("userInfo"),{type:p}))}})]}),Object(R.jsxs)("div",{className:"header d-flex justify-content-between",children:[Object(R.jsx)("h1",{className:"header-title",children:"JS Band Store"}),Object(R.jsxs)(M.b,{to:"/cart",className:"shopping-cart",style:{textDecoration:"none"},children:[Object(R.jsx)("i",{className:"fas fa-shopping-cart"}),"Cart(".concat(c.length,")")]})]})]}):null},W=(c(78),c(79),Object(V.g)((function(e){var t=e.book,c=e.history,a=Object(s.b)(),r=t.title,n=t.author,o=t.price,i=t.cover,l=t.id;return Object(R.jsxs)("div",{className:"card",children:[Object(R.jsx)("img",{src:i,className:"card-text card-img",alt:r}),Object(R.jsxs)("div",{className:"card-body",children:[Object(R.jsx)("h5",{className:"card-title",children:r}),Object(R.jsx)("p",{className:"card-text",children:n}),Object(R.jsxs)("div",{className:"d-flex footer-card-section",children:[Object(R.jsxs)("p",{className:"card-text",children:[o," $"]}),Object(R.jsx)("button",{className:"btn btn-info",onClick:function(){c.push("/catalog/".concat(l)),a({type:x})},children:"View"})]})]})]})}))),H=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.books})),c=Object(s.c)((function(e){return e.user})),r=Object(s.c)((function(e){return e.error})),n=Object(s.c)((function(e){return e.loading})),o=Object(s.c)((function(e){return e.filterPriceValue})),i=Object(s.c)((function(e){return e.filterTitleValue}));Object(a.useEffect)((function(){var t;c.token&&e((t=c.token,function(){var e=Object(B.a)(_.a.mark((function e(c){var a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.getAllBooks(t);case 3:a=e.sent,c({type:h,books:a}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message),c({type:d,err:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}),[e,c.token]);var l=function(e,t){return"Price"===t?e:"< 25"===t?e.filter((function(e){return e.price<25})):"< 50"===t?e.filter((function(e){var t=e.price;return t>25&&t<50})):"> 50"===t?e.filter((function(e){return e.price>50})):void 0}(function(e,t){return""===t?e:e.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}))}(t,i),o).map((function(e){return Object(R.jsx)(W,{book:e},e.id)}));if(!c.token)return Object(R.jsx)(V.a,{to:"/login"});var u=!(n||r)?l:null;return Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{className:"d-flex",children:[Object(R.jsx)(ee,{}),Object(R.jsx)(te,{})]}),Object(R.jsxs)("div",{className:"book-list",children:[r&&Object(R.jsx)(G,{}),n&&Object(R.jsx)(J,{}),u]})]})},Q=(c(80),function(e){var t=e.itemId,c=Object(s.c)((function(e){return e.bookDetails})),r=Object(s.c)((function(e){return e.user})),n=Object(s.c)((function(e){return e.error})),o=Object(s.c)((function(e){return e.loading})),i=Object(s.b)();if(Object(a.useEffect)((function(){var e,c;r.token&&i((e=r.token,c=t,function(){var t=Object(B.a)(_.a.mark((function t(a){var r;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.loadBook(e,c);case 3:r=t.sent,a({type:f,bookDetails:r}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0.message),a({type:d,err:t.t0});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()))}),[i,t,r]),!r.token)return Object(R.jsx)(V.a,{to:"/login"});var l=!(o||n)&&c?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(X,{bookDetails:c}),Object(R.jsx)(Z,{bookDetails:c})]}):null;return Object(R.jsxs)("div",{className:"card-details d-flex",children:[n&&Object(R.jsx)(G,{}),o&&Object(R.jsx)(J,{}),l]})}),X=function(e){var t=e.bookDetails,c=t.title,a=t.cover,r=t.description,n=t.author,s=t.tags;return Object(R.jsxs)("div",{className:"d-flex info-container",children:[Object(R.jsxs)("div",{className:"image-container",children:[Object(R.jsx)("img",{className:"image",src:a,alt:c}),Object(R.jsx)("p",{className:"book-desc",children:r})]}),Object(R.jsxs)("div",{children:[Object(R.jsx)("h5",{className:"card-title",children:c}),Object(R.jsx)("p",{className:"book-auth",children:Object(R.jsx)("small",{children:n})}),Object(R.jsxs)("div",{className:"tags",children:[Object(R.jsx)("i",{className:"fas fa-tags"}),s&&s.join(", ")]})]})]})},Z=(c(81),function(e){var t=e.bookDetails,c=Object(s.b)(),r=(Object(s.c)((function(e){return e.booksInTheCart})),t.price),n=t.count,o=t.id,i=t.title,l=Object(a.useState)(0),j=Object(I.a)(l,2),b=j[0],d=j[1],O=Object(a.useState)(0),h=Object(I.a)(O,2),p=h[0],f=h[1],x=Object(a.useState)({name:i,id:o,price:r,count:null,total:null}),v=Object(I.a)(x,2),g=v[0],k=v[1];return Object(R.jsx)("div",{className:"card book-cart",children:Object(R.jsxs)("div",{className:"card-body",children:[Object(R.jsxs)("div",{className:"price d-flex",children:[Object(R.jsx)("p",{className:"card-text",children:"Price, $"}),Object(R.jsx)("p",{children:r})]}),Object(R.jsxs)("div",{className:"d-flex count",children:[Object(R.jsx)("p",{className:"card-text",children:"Count"}),Object(R.jsx)("input",{className:"count-input",type:"number",value:b,onChange:function(e){var t=e.target.value;d(t),f((t*r).toFixed(2)),k(Object(u.a)(Object(u.a)({},g),{},{count:t,total:(t*r).toFixed(2)}))},min:"1",max:n})]}),Object(R.jsxs)("div",{className:"d-flex total",children:[Object(R.jsx)("p",{className:"card-text",children:"Total Price, $"}),Object(R.jsx)("p",{className:"card-text",children:p})]}),Object(R.jsx)("button",{className:"btn btn-info add-to-cart",onClick:function(){b&&c(function(e){return{type:m,addedBook:e}}(g))},children:"Add to cart"})]})})}),ee=(c(82),function(){var e=Object(s.b)();return Object(R.jsxs)("select",{className:"custom-select price-filter",onChange:function(t){var c;e((c=t.target.value,{type:v,priceFilterValue:c}))},children:[Object(R.jsx)("option",{value:"Price",children:"Price"}),Object(R.jsx)("option",{value:"< 25",children:"price < 25"}),Object(R.jsx)("option",{value:"< 50",children:"25 < price < 50"}),Object(R.jsx)("option",{value:"> 50",children:"price > 50"})]})}),te=(c(83),function(){var e=Object(s.b)();return Object(R.jsxs)("div",{className:"form-group has-search",children:[Object(R.jsx)("span",{className:"fa fa-search form-control-feedback"}),Object(R.jsx)("input",{type:"text",className:"form-control",placeholder:"type to search",onChange:function(t){var c;e((c=t.target.value,{type:g,titleFilterValue:c}))}})]})}),ce=(c(84),function(){var e=Object(s.c)((function(e){return e.booksInTheCart})),t=Object(s.c)((function(e){return e.user})),c=Object(s.b)(),a=e.reduce((function(e,t){if(1===t.count)e+="".concat(t.id,",");else for(var c=0;c<t.count;c++)e+="".concat(t.id,",");return e}),"").slice(0,-1);return t.token?0===e.length?Object(R.jsxs)("div",{className:"shopping-cart-page",children:[Object(R.jsx)("i",{className:"fas fa-shopping-cart"}),Object(R.jsx)("p",{className:"empty-cart",children:"Cart empty..."})]}):Object(R.jsxs)("div",{className:"full-cart",children:[Object(R.jsx)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:Object(R.jsx)("button",{className:"btn btn-info me-md-2 purchase",type:"button","data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",onClick:function(){return c((e=t.token,r=a,function(){var t=Object(B.a)(_.a.mark((function t(c){var a;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.postPurchase(e,r);case 3:a=t.sent,c({type:k,messageAfterPurchase:a}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0.message),c({type:d,err:t.t0});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));var e,r},children:"Purchase"})}),Object(R.jsx)("div",{className:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:Object(R.jsx)("div",{className:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg",children:Object(R.jsxs)("div",{className:"modal-content",children:[Object(R.jsx)("div",{className:"modal-header",children:Object(R.jsx)("h6",{className:"modal-title",id:"staticBackdropLabel",children:"You successfully placed an order!"})}),Object(R.jsx)("div",{className:"modal-body",children:Object(R.jsx)(ae,{booksInTheCart:e})}),Object(R.jsx)("div",{className:"modal-footer",children:Object(R.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:function(){return c({type:N})},children:"Close"})})]})})}),Object(R.jsx)(ae,{booksInTheCart:e})]}):Object(R.jsx)(V.a,{to:"/login"})}),ae=function(e){var t=e.booksInTheCart;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)("table",{className:"table table-striped",children:[Object(R.jsx)("thead",{children:Object(R.jsxs)("tr",{children:[Object(R.jsx)("th",{scope:"col",children:"Name"}),Object(R.jsx)("th",{scope:"col",children:"Count"}),Object(R.jsx)("th",{scope:"col",children:"Price"}),Object(R.jsx)("th",{scope:"col",children:"Total"})]})}),Object(R.jsx)("tbody",{children:t.map((function(e){return Object(R.jsxs)("tr",{children:[Object(R.jsx)("th",{scope:"row",className:"book-title",children:e.name}),Object(R.jsx)("td",{children:e.count}),Object(R.jsx)("td",{children:e.price}),Object(R.jsx)("td",{children:e.total})]},e.id)}))})]}),Object(R.jsxs)("div",{className:"total-price",children:["Total price:\xa0",t.reduce((function(e,t){return e+ +t.total}),0).toFixed(2),"\xa0 $"]})]})},re=(c(85),function(){var e=Object(s.c)((function(e){return e.user}));return Object(R.jsxs)("div",{className:"container",children:[e.token&&Object(R.jsx)(q,{}),Object(R.jsxs)(V.d,{children:[Object(R.jsx)(V.b,{path:"/finalTask/",render:function(){return!e.token&&Object(R.jsx)(V.a,{to:"/finalTask/login"})},exact:!0}),Object(R.jsx)(V.b,{path:"/finalTask/login",component:U}),Object(R.jsx)(V.b,{path:"/finalTask/cart",component:ce}),Object(R.jsx)(V.b,{path:"/finalTask/catalog/:id",render:function(e){var t=e.match.params.id;return Object(R.jsx)(Q,{itemId:t})}}),Object(R.jsx)(V.b,{exact:!0,path:"/finalTask/catalog",component:H}),Object(R.jsx)(V.a,{to:"/finalTask/"})]})]})});n.a.render(Object(R.jsx)(s.a,{store:T,children:Object(R.jsx)(Y,{children:Object(R.jsx)(M.a,{children:Object(R.jsx)(re,{})})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.10df0403.chunk.js.map